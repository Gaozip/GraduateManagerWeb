<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.whale.dao.ResumeProjectMapper">
  
  <resultMap id="resumeProjectMapperMap" type="org.whale.pojo.ResumeProject">
   <id column="PK_RESUME_PROJECT" jdbcType="DECIMAL" property="pkResumeProject" />
    <result column="PROJECT_NAME" jdbcType="VARCHAR" property="projectName" />
    <result column="PROJECT_DESCRIPTION" jdbcType="VARCHAR" property="projectDescription" />
    <result column="PERSONAL_RESPONSIBILITY" jdbcType="VARCHAR" property="personalResponsibility" />
    <result column="COMPANY_NAME" jdbcType="VARCHAR" property="companyName" />
    <result column="PROJECT_DATE" jdbcType="VARCHAR" property="projectDate" />
    <result column="FK_RESUME_ID" jdbcType="DECIMAL" property="fkResumeId" />
  </resultMap>
  
  <insert id="doSave" parameterType="java.util.List">
    insert into SYS_RESUME_PROJECT (PK_RESUME_PROJECT, PROJECT_NAME, PROJECT_DESCRIPTION, PERSONAL_RESPONSIBILITY, COMPANY_NAME, FK_RESUME_ID, PROJECT_DATE)
    select SEQ_SYS_RESUME_PROJECT.nextval, t.* from(
    	<foreach collection="list" item="item" index="index" separator="UNION ALL">
    		select
		    	#{item.projectName,jdbcType=VARCHAR}, 
		    	#{item.projectDescription,jdbcType=VARCHAR}, 
		      	#{item.personalResponsibility,jdbcType=VARCHAR}, 
		      	#{item.companyName,jdbcType=VARCHAR}, 
		      	#{item.fkResumeId,jdbcType=DECIMAL}, 
		      	#{item.projectDate,jdbcType=VARCHAR}
	    	from DUAL
	    </foreach>
	 )t
  </insert>
  
  <select id="getResumeProjectByResumeId" resultMap="resumeProjectMapperMap" parameterType="Long">
  	select * from sys_resume_project where fk_resume_id = #{fkResumeId,jdbcType=DECIMAL}
  </select>
 
  <update id="doUpdateByResumeId" parameterType="java.util.List" >
  	 <foreach collection="list" item="item" index="index" separator=";">
  	 	update SYS_RESUME_PROJECT
    	set 
    		PROJECT_NAME = #{item.projectName,jdbcType=VARCHAR},
      		PROJECT_DESCRIPTION = #{item.projectDescription,jdbcType=VARCHAR},
      		PERSONAL_RESPONSIBILITY = #{item.personalResponsibility,jdbcType=VARCHAR},
      		COMPANY_NAME = #{item.companyName,jdbcType=VARCHAR},
      		PROJECT_DATE = #{item.projectDate,jdbcType=VARCHAR}
    	where 
    		FK_RESUME_ID = #{item.fkResumeId,jdbcType=DECIMAL}
  	 </foreach>
  </update>
  
  <delete id="doDeleteByResumeId" parameterType="java.lang.Long">
  	 delete from SYS_RESUME_PROJECT where FK_RESUME_ID = #{fkResumeId,jdbcType=DECIMAL}
  </delete>
</mapper>